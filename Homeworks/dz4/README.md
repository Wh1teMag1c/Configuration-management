# Учебная виртуальная машина
## Описание
Данный проект реализует ассемблер и интерпретатор для учебной виртуальной машины (УВМ).

Ассемблер отвечает за преобразование исходных программ, написанных на текстовом представлении ассемблера УВМ, в бинарные файлы, пригодные для выполнения. В дополнение к бинарному файлу, ассемблер создает файл-лог, содержащий ассемблированные инструкции в формате "ключ=значение".

Интерпретатор выполняет команды из бинарного файла, поддерживая базовую работу со стеком и памятью. Результатом выполнения является файл-результат, содержащий значения из заданного диапазона памяти УВМ.

## Структура проекта

- ```assembler.py```  
Ассемблер для преобразования текстовых исходных программ (файл .asm) в бинарный файл (файл .bin).
Дополнительно создает лог-файл (log.json) с ассемблированными инструкциями.

- ```interpreter.py```  
Интерпретатор для выполнения команд УВМ из бинарного файла (файл .bin) и записи результатов выполнения в файл (result.json).

- ```program.asm```  
Пример текстовой программы на языке ассемблера для УВМ.

- ```program.bin```  
Бинарный файл, созданный ассемблером на основе входной программы.

- ```log.json```  
Лог-файл, содержащий ассемблированные инструкции в формате ключ=значение.

- ```result.json```  
Файл с результатами выполнения интерпретатором команд из заданного диапазона памяти.


## Система команд УВМ

### 1. Загрузка константы
- **Размер команды**: 3 байта
- **Операнд**: поле B
- **Результат**: новый элемент на стеке
- **Пример команды**: (A=7, B=711)
- **Машинный код**: `0xE7, 0x58, 0x00`

### 2. Чтение значения из памяти
- **Размер команды**: 2 байта
- **Операнд**: значение в памяти по адресу, которым является сумма адреса (элемент, снятый с вершины стека) и смещения (поле B)
- **Результат**: новый элемент на стеке
- **Пример команды**: (A=23, B=146)  
- **Машинный код**: `0x57, 0x12`

### 3. Запись значения в память
- **Размер команды**: 2 байта
- **Операнд**: элемент, снятый с вершины стека
- **Результат**: значение в памяти по адресу, которым является сумма адреса (элемент, снятый с вершины стека) и смещения (поле B)
- **Пример команды**: (A=24, B=140)  
- **Машинный код**: `0x98, 0x11`

### 4. Унарная операция: popcnt()
- **Размер команды**: 2 байта
- **Операнд**: значение в памяти по адресу, которым является сумма адреса (элемент, снятый с вершины стека) и смещения (поле B)
- **Результат**: значение в памяти по адресу, которым является элемент, снятый с вершины стека
- **Пример команды**: (A=17, B=192):  
- **Машинный код**: `0x11, 0x18`

### Тестовая программа  
Выполнить поэлементно операцию popcnt() над вектором длины 5. Результат записать в новый вектор.

## Установка
**Клонируйте репозиторий:**
```bash
git clone <URL репозитория>
cd <директория проекта>>
```

## Использование
1. **Компиляция программы** (Ассемблер):
   ```bash
   python assembler.py <путь_к_исходному_файлу> <путь_к_бинарному_файлу> <путь_к_файлу_логу>
   ```
    Для запуска программы ассемблера используйте:
    ```bash
    python assembler.py program.asm program.bin log.json   
    ```
2. **Выполнение программы** (Интерпретатор):
    ```bash
    python interpreter.py <путь_к_бинарному_файлу> <путь_к_файлу_результатов> <диапазон_памяти>  
    ```
   Для запуска программы интерпретатора используйте:
    ```bash
   python interpreter.py program.bin result.json 0,256 
    ```
   
## Тестирование
Выполнить поэлементно операцию popcnt() над вектором длины 5. Результат записать в новый вектор.

Запуск программы ассемблера:
   ```bash
    python assembler.py program.asm program.bin log.json   
   ```
Запуск программы интерпретатора:
   ```bash
    python interpreter.py program.bin result.json 0,256  
   ```
**Входные данные**: вектор со значениями [11, 12, 13, 14, 15]

**Ожидаемые данные**: поэлементная операция popcnt() над вектором длины 5, запись в новый вектор: [11, 12, 13, 14, 15]

**Результат**:  
![image](https://github.com/user-attachments/assets/1ede84d8-e7d8-459a-9fa7-17e4b2a27e0f)
